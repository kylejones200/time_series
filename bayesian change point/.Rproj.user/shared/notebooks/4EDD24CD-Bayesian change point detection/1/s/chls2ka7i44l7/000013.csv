"0",""
"0","# start at 2, so you can use initialization values as seeds"
"0","# and go through this process once for each of your m iterations"
"0","for (i in 2:m) {"
"0"," kt <- k[i-1] # start w/random year from initialization"
"0"," # set your shape parameter to pick mu from, based on the characteristics"
"0"," # of the early (""before"") chunk of your data"
"0"," r <- .5 + sum(y[1:kt]) "
"0"," # now use it to pick mu"
"0"," mu[i] <- rgamma(1,shape=r,rate=kt+b1) "
"0"," # if you're at the end of the time periods, set your shape parameter"
"0"," # to 0.5 + the sum of all the frequencies, otherwise, just set the shape"
"0"," # parameter that you will use to pick lambda based on the later (""after"")"
"0"," # chunk of your data"
"0"," if (kt+1 > n) r <- 0.5 + sum(y) else r <- 0.5 + sum(y[(kt+1):n])"
"0"," lambda[i] <- rgamma(1,shape=r,rate=n-kt+b2)"
"0"," # now use the mu and lambda values that you got to set b1 and b2 for next iteration"
"0"," b1 <- rgamma(1,shape=.5,rate=mu[i]+1)"
"0"," b2 <- rgamma(1,shape=.5,rate=lambda[i]+1)"
"0"," # for each year, find value of LIKELIHOOD function which you will "
"0"," # then use to determine what year to hop to next"
"0"," for (j in 1:n) {"
"0"," L[j] <- exp((lambda[i]-mu[i])*j) * (mu[i]/lambda[i])^sum(y[1:j])"
"0"," }"
"0"," L <- L/sum(L)"
"0"," # determine which year to hop to next"
"0"," k[i] <- sample(1:n,prob=L,size=1)"
"0","}"
"2","Error in sample.int(length(x), size, replace, prob) : 
  NA in probability vector
"
